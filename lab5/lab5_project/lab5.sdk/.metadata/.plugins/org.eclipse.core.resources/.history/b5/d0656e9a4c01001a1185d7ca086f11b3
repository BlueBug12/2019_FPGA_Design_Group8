#include <stdio.h>
#include "xil_printf.h"
#include "xil_io.h"
#include "xparameters.h"
#include "mem_control.h"


int main()
{
	u32	output_data;
	u32 instruction[10];
	u32 input_data = 0x12341234; //a = 1,2,3,4 b = 1, 2, 3, 4

	//initial instructions
	instruction[0] = 0x000000fe;
	instruction[1] = 0x100000fd;
	instruction[2] = 0x200000fc;
	instruction[3] = 0x300000fb;
	instruction[4] = 0x400000fa;
	instruction[5] = 0x70000000;

	//store instructions to mem
	write_data(0x00000001, instruction[0], 0);
	write_data(0x00000002, instruction[1], 0);
	write_data(0x00000003, instruction[2], 0);
	write_data(0x00000004, instruction[3], 0);
	write_data(0x00000005, instruction[4], 0);
	write_data(0x00000006, instruction[5], 0);
	write_data(0x00000000, 0x00000000, 1);//trigger pl

	u32 mask = 0x00000002;
	u32 pl_done = 0;
	while(pl_done){
		pl_done = mask & Xil_In32(XPAR_MEM_CONTROL_0_S00_AXI_BASEADDR);
	}

    data = read_data(0x000000fe);
    printf("Data = %d\n\r", data);

    data = read_data(0x000000fd);
    printf("Data = %d\n\r", data);

    data = read_data(0x000000fc);
    printf("Data = %d\n\r", data);

    data = read_data(0x000000fb);
    printf("Data = %d\n\r", data);

    data = read_data(0x000000fa);
    printf("Data = %d\n\r", data);

    return 0;
}
